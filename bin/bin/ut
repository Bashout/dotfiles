#!/bin/sh

# A more minimal version of t (http://stevelosh.com/projects/t/)

# NOTE: 50 LOC maximum

todo_file="$HOME/.todo.txt"
[ ! -f "$todo_file" ] && touch "$todo_file"

# TODO maybe use getopts?
# TODO if there is a TODO file use that?

if [ "$#" -eq 0 ]; then
    cat "$todo_file"
elif [ "$1" == "-u" ]; then
    printf "usage: %s [-mu] [-e id] [-f pattern] [text]\\n" "$0"
elif [ "$1" == "-e" ]; then
    # TODO Edit a task
    shift
    echo "-e was passed"
elif [ "$1" == "-f" ]; then
    # Complete/remove a task
    shift
    args="$@"
    pattern=$(printf "/%s/d" "$args")
    sed -i "$pattern" "$todo_file"
elif [ "$1" == "-m" ]; then
    # Open the task file in a text editor
    "$EDITOR" "$todo_file"
else
    # Add a task to the task file
    id=$(date +'%Y-%m-%d %T.%N %s' | sha1sum | cut -c 38-40)
    echo "$id" - "$@" >> "$todo_file"
fi
